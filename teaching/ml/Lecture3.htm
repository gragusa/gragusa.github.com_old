<!DOCTYPE html>
<!-- saved from url=(0041)http://127.0.0.1:7969/HTML3-Shrinkage.Rmd -->
<html class="gr__127_0_0_1"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>window.readcubeExtension = {
  version: '1.12',
  id: 'mfacblegickmnfpaebakfnlbfhpoegin'
};</script>

    <script type="application/shiny-singletons"></script>  <script type="application/html-dependencies">json2[2014.02.04];jquery[1.11.3];shiny[0.13.2]</script><script src="./Lecture3_files/json2-min.js"></script>
<script src="./Lecture3_files/jquery.min.js"></script>
<link href="./Lecture3_files/shiny.css" rel="stylesheet">
<script src="./Lecture3_files/shiny.min.js"></script>  <script src="./Lecture3_files/rmd_loader.js"></script>
  <link href="./Lecture3_files/rmd_loader.css" rel="stylesheet">

<script src="./Lecture3_files/rsiframe.js"></script><meta name="0" content="[object Object]"><link rel="stylesheet" type="text/css" href="./Lecture3_files/bootstrap.min.css"><script src="./Lecture3_files/bootstrap.min.js"></script><script src="./Lecture3_files/html5shiv.min.js"></script><script src="./Lecture3_files/respond.min.js"></script><link rel="stylesheet" type="text/css" href="./Lecture3_files/rmd_perf.css"><script src="./Lecture3_files/rmd_perf.js"></script>



<meta name="generator" content="pandoc">


<meta name="author" content="Giuseppe Ragusa">


<title>Lecture 3</title>


<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet" href="./Lecture3_files/default.css" type="text/css">
<script src="./Lecture3_files/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<script type="text/javascript" src="./Lecture3_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body data-gr-c-s-loaded="true"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
  <div>
    <div data-display-if="!output.__reactivedoc__" style="display: none;">
      <div id="rmd_loader_wrapper">
        <div id="rmd_loader">
          <img src="./Lecture3_files/rmd_loader.gif">
          <p>Loading</p>
        </div>
      </div>
    </div>
    <div id="__reactivedoc__" class="shiny-html-output shiny-bound-output">







<style type="text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="./Lecture3_files/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lecture 3</h1>
<h4 class="author"><em>Giuseppe Ragusa</em></h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Last time we have spoken about the compromise between bias and variance:</p>
<ul>
<li><p>The higher the flexibility of the model , the lower the bias, but the higher the variance.</p></li>
<li><p>The more a model is simple, the lower the variance but the higher the bias</p></li>
</ul>
</div>
<div id="linear-model-review" class="section level1">
<h1>Linear Model: Review</h1>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 15.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1012.56em 2.979em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-7" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-8" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mn" id="MathJax-Span-9" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-10" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-11" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mn" id="MathJax-Span-13" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-15" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mn" id="MathJax-Span-18" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-19" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-20" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular;">+</span><span class="mo" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">+</span><span class="msubsup" id="MathJax-Span-26"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-36" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-37" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-38" style="font-family: STIXGeneral-Italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>β</mi><mi>k</mi></msub><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">
\begin{equation}
    \nonumber
    y_i = \beta_0 + \beta_1 x_{1,i} + ... + \beta_k x_{k,i}  + \epsilon_i
\end{equation}
</script></span></p>
<p>In a more compact way:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-40" role="math" style="width: 3.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em 1003.04em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-41"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="munderover" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.241em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-46" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mi>X</mi><mi>β</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">
\begin{equation}
    \hat{Y}= X\beta
\end{equation}
</script></span></p>
<p>The OLS estimators solve: <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mi&gt;argmin&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" role="math" style="width: 14.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em 1011.73em 4.11em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-51"><span class="msubsup" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="munderover" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-57" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">O</span><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-63" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="munder" id="MathJax-Span-64" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1002.8em 4.408em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral-Regular;">argmin</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.36em 4.408em -999.997em); top: -2.854em; left: 1.253em;"><span class="texatom" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="munderover" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.289em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.301em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-70" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.176em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="munderover" id="MathJax-Span-71" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-72" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.289em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-73"><span class="mrow" id="MathJax-Span-74"><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-77" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.17em -999.997em); top: -5.176em; left: 0.479em;"><span class="mi" id="MathJax-Span-78" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-82" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-84" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-85" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-86" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-89" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="mn" id="MathJax-Span-90" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.711em; border-left: 0px solid; width: 0px; height: 3.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo>=</mo><munder><mi>argmin</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow></munder><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>X</mi><mi>i</mi></msub><mi>β</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">
\begin{equation}
    \nonumber
    \hat{\beta}^{OLS} = \underset{\hat{\beta}}{\operatorname{argmin}} \sum_{i=1}^n (y_i - X_i\beta)^2
\end{equation}
</script></span></p>
<p>Taking the linear projection of Y onto X:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" role="math" style="width: 17.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.884em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em 1014.88em 3.634em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-92"><span class="mfrac" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 3.455em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1003.28em 4.348em -999.997em); top: -4.699em; left: 50%; margin-left: -1.664em;"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-97" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-98" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-99" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-100" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-101" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.271em; left: 50%; margin-left: -0.235em;"><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1003.46em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.455em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-104" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span><span class="mo" id="MathJax-Span-105" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">→</span><span class="texatom" id="MathJax-Span-106" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-107"><span class="munderover" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(2.92em 1001.91em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="msubsup" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-110" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-111"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">O</span><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.42em 3.872em -999.997em); top: -4.699em; left: 0.717em;"><span class="mo" id="MathJax-Span-116" style="font-family: STIXGeneral-Regular;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-118" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">(</span><span class="msup" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-121" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-122" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mo" id="MathJax-Span-127" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-128" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-130" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-132" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>d</mi><mi>R</mi><mi>S</mi><mi>S</mi><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mrow><mi>β</mi></mfrac><mo>=</mo><mn>0</mn><mo stretchy="false">→</mo><mrow class="MJX-TeXAtom-ORD"><mover><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mo>′</mo></msup><mi>Y</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">
\begin{equation}
    \nonumber
   \frac{dRSS(\beta)}{\beta} = 0 \rightarrow  \hat{\beta^{OLS}} = (X'X)^{-1}X'Y
\end{equation}
</script></span></p>
<p>The general formula of the standard error:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" role="math" style="width: 20.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em 1017.15em 3.991em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-136" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-137" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-138" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="munderover" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(2.92em 1001.91em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="msubsup" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">O</span><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.42em 3.872em -999.997em); top: -4.699em; left: 0.717em;"><span class="mo" id="MathJax-Span-149" style="font-family: STIXGeneral-Regular;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-151" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-152" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">(</span><span class="msubsup" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-154" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-158" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mo" id="MathJax-Span-161" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-162" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral-Regular;">(</span><span class="munderover" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-165" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.289em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-166"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-169" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-170" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.17em -999.997em); top: -5.176em; left: 0.479em;"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-172" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-173" style="font-family: STIXGeneral-Italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.42em 4.17em -999.997em); top: -4.342em; left: 0.42em;"><span class="mn" id="MathJax-Span-174" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.17em -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-175" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-176"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-177" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.54em 4.17em -999.997em); top: -4.342em; left: 0.479em;"><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.17em -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-180"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-181" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-182" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-183" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-188" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-189"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mo" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-194" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.568em; border-left: 0px solid; width: 0px; height: 3.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>ϵ</mi><mi>i</mi><mn>2</mn></msubsup><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">
\begin{equation}
Var(\hat{\beta^{OLS}}) = (X^TX)^{-1} (\sum_{i=1}^n \epsilon_i^2 x_i^Tx_i) (X^TX)^{-1}    
\end{equation}
</script></span></p>
<p>And under the assumption of homoskedasticity:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-195" role="math" style="width: 11.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.586em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1009.59em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-198" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-199" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-200" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-202"><span class="mrow" id="MathJax-Span-203"><span class="munderover" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-205" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-206" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-207"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">O</span><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-211" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-212" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-213" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-214" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-215" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mn" id="MathJax-Span-216" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-219" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-222"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-223" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mo" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-227" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">
\begin{equation}
    \nonumber
    Var(\hat{\beta}^{OLS}) = \sigma^2 (X'X)^{-1}
\end{equation}
</script></span></p>
<p><strong>What happen if some variable are highly correlated each other?</strong></p>
<p><br></p>
<p>To avoid singularity problems of the (X’X) matrix you can add a ridge to the matrix:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-228" role="math" style="width: 10.241em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.515em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1008.51em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-229"><span class="msubsup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-231"><span class="mrow" id="MathJax-Span-232"><span class="munderover" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-234" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-235" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-236"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-240" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-241" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">(</span><span class="msup" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-245" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-246" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral-Regular;">)</span><span class="msup" id="MathJax-Span-250"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-251" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-253" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mi>R</mi></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><mo>+</mo><mi>λ</mi><mi>I</mi><mo stretchy="false">)</mo><msup><mi>X</mi><mo>′</mo></msup><mi>Y</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">
\begin{equation}
    \nonumber
    \hat{\beta}^{RR} = (X'X + \lambda I) X'Y
\end{equation}
</script></span></p>
<p>Where <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-254" role="math" style="width: 12.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.205em 1010.42em 7.92em -999.997em); top: -5.295em; left: 0.003em;"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-257" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-258" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-259" style="vertical-align: 2.92em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.33em; left: 0.003em;">⎡<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.074em; left: 0.003em;">⎣<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.438em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.545em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.711em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.182em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mtable" id="MathJax-Span-260" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 7.622em; height: 0px;"><span style="position: absolute; clip: rect(3.039em 1000.48em 8.455em -999.997em); top: -6.009em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.42em 4.17em -999.997em); top: -6.128em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mn" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-278"><span class="mrow" id="MathJax-Span-279"><span class="mn" id="MathJax-Span-280" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.211em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mn" id="MathJax-Span-312" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.015em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.48em 8.455em -999.997em); top: -6.009em; left: 1.61em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -6.128em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mn" id="MathJax-Span-266" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.42em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mn" id="MathJax-Span-283" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.211em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mo" id="MathJax-Span-300" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mn" id="MathJax-Span-315" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.015em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.48em 8.455em -999.997em); top: -6.009em; left: 3.277em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -6.128em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mn" id="MathJax-Span-269" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-284"><span class="mrow" id="MathJax-Span-285"><span class="mn" id="MathJax-Span-286" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.211em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-301"><span class="mrow" id="MathJax-Span-302"><span class="mo" id="MathJax-Span-303" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-316"><span class="mrow" id="MathJax-Span-317"><span class="mn" id="MathJax-Span-318" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.015em;"></span></span><span style="position: absolute; clip: rect(3.098em 1001.07em 7.92em -999.997em); top: -5.473em; left: 4.884em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.693em 1001.07em 4.17em -999.997em); top: -6.128em; left: 50%; margin-left: -0.533em;"><span class="mtd" id="MathJax-Span-270"><span class="mrow" id="MathJax-Span-271"><span class="mo" id="MathJax-Span-272" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-273" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-274" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.693em 1001.07em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.533em;"><span class="mtd" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mo" id="MathJax-Span-289" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-290" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-291" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.211em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-304"><span class="mrow" id="MathJax-Span-305"><span class="mo" id="MathJax-Span-306" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.693em 1001.07em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.533em;"><span class="mtd" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mo" id="MathJax-Span-321" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-322" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-323" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.479em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.48em 8.396em -999.997em); top: -6.009em; left: 7.146em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -6.128em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-275"><span class="mrow" id="MathJax-Span-276"><span class="mn" id="MathJax-Span-277" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="mn" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.211em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mn" id="MathJax-Span-309" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.42em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mn" id="MathJax-Span-326" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-327" style="vertical-align: 2.92em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.33em; left: 0.003em;">⎤<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.074em; left: 0.003em;">⎦<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.438em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.545em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.711em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.182em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.301em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.996em; border-left: 0px solid; width: 0px; height: 6.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>:</mo></mtd><mtd><mo>:</mo></mtd><mtd><mo>:</mo></mtd><mtd><mo>:</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">
I =
  \begin{bmatrix}
    1 & 0 & 0 & ... & 0   \\
    0 & 1 & 0 & ... & 0   \\
    : & : & : & : & 0\\
    0 & 0 & 0  & ... &1  \\
  \end{bmatrix}
</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-328" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1002.21em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-family: STIXGeneral-Italic;">λ</span><span class="mo" id="MathJax-Span-331" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">&gt;</span><span class="mn" id="MathJax-Span-332" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>&gt;</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">\lambda > 0</script></span></p>
<p><br></p>
<p>Note: for any <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-333" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1002.21em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-family: STIXGeneral-Italic;">λ</span><span class="mo" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">&gt;</span><span class="mn" id="MathJax-Span-337" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>&gt;</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">\lambda > 0</script></span> <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-338" role="math" style="width: 2.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em 1002.32em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-339"><span class="mo" id="MathJax-Span-340" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.717em;"><span class="mo" id="MathJax-Span-343" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-344" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-345" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">(X'X)</script></span> is not singular, why?</p>
<p>This is equivalent to solve</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mi&gt;min&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" role="math" style="width: 8.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.265em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em 1007.26em 3.991em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-347"><span class="munder" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1001.55em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-349" style="font-family: STIXGeneral-Regular;">min</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.36em 4.408em -999.997em); top: -3.033em; left: 0.598em;"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="munderover" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.289em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-353" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.301em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-354" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.176em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="munderover" id="MathJax-Span-355" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-356" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.289em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-360" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-361" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.17em -999.997em); top: -5.176em; left: 0.479em;"><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-363" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-365" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-367" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-368" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-369" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-370" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-371" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-372"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-373" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="mn" id="MathJax-Span-374" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.568em; border-left: 0px solid; width: 0px; height: 3.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mi>min</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow></munder><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>X</mi><mi>i</mi></msub><mi>β</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">
\begin{equation}
\nonumber
    \underset{\hat{\beta}}{\operatorname{min}} \sum_{i=1}^n (y_i - X_i\beta)^2 
\end{equation}
</script></span></p>
<p>subject to</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-375" role="math" style="width: 5.241em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.348em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.717em 1004.35em 4.11em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-376"><span class="munderover" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-378" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.408em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-382" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.289em -999.997em); top: -5.235em; left: 0.479em;"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-385" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-386" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.42em 4.17em -999.997em); top: -4.342em; left: 0.598em;"><span class="mn" id="MathJax-Span-387" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.289em -999.997em); top: -3.688em; left: 0.539em;"><span class="mi" id="MathJax-Span-388" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-389" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">&lt;</span><span class="mi" id="MathJax-Span-390" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.711em; border-left: 0px solid; width: 0px; height: 3.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msubsup><mi>β</mi><mi>j</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>C</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">
\begin{equation}
\nonumber
    \sum_{j=1}^p \beta_j^2 < C
\end{equation}
</script></span></p>
<p>with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" role="math" style="width: 2.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1002.38em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-394" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">&gt;</span><span class="mn" id="MathJax-Span-395" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>&gt;</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-14">C > 0</script></span></p>
<p><br></p>
<p><br></p>
<p>Which is equivalent to…</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mi&gt;argmin&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-396" role="math" style="width: 18.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.717em 1015.42em 4.11em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-397"><span class="msubsup" id="MathJax-Span-398"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="munderover" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-402" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-403" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-404"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="munder" id="MathJax-Span-409" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1002.8em 4.408em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral-Regular;">argmin</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em 1000.36em 4.408em -999.997em); top: -2.854em; left: 1.253em;"><span class="texatom" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="munderover" id="MathJax-Span-413"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.289em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.301em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.176em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="munderover" id="MathJax-Span-416" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-417" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.289em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="mi" id="MathJax-Span-420" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-421" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-422" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.17em -999.997em); top: -5.176em; left: 0.479em;"><span class="mi" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-424" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-425"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-426" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-428" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="msubsup" id="MathJax-Span-429" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-430" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="mi" id="MathJax-Span-431" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-432" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-434" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="mn" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-436" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-437" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span><span class="munderover" id="MathJax-Span-438" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-439" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.408em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-440"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.289em -999.997em); top: -5.235em; left: 0.479em;"><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-446" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-447" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.42em 4.17em -999.997em); top: -4.342em; left: 0.598em;"><span class="mn" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.289em -999.997em); top: -3.688em; left: 0.539em;"><span class="mi" id="MathJax-Span-449" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.711em; border-left: 0px solid; width: 0px; height: 3.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mi>R</mi></mrow></msup><mo>=</mo><munder><mi>argmin</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow></munder><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>X</mi><mi>i</mi></msub><mi>β</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msubsup><mi>β</mi><mi>j</mi><mn>2</mn></msubsup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">
\begin{equation}
    \nonumber
  \hat{\beta}^{RR} = \underset{\hat{\beta}}{\operatorname{argmin}} \sum_{i=1}^n (y_i - X_i\beta)^2 + \lambda \sum_{j=1}^p \beta_j^2
\end{equation}
</script></span></p>
<ul>
<li>If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-450" role="math" style="width: 3.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1002.8em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-451"><span class="mi" id="MathJax-Span-452" style="font-family: STIXGeneral-Italic;">λ</span><span class="mo" id="MathJax-Span-453" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">→</span><span class="mi" id="MathJax-Span-454" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">\lambda \rightarrow \infty</script></span> then <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-455" role="math" style="width: 4.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.396em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1003.4em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-456"><span class="msubsup" id="MathJax-Span-457"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="munderover" id="MathJax-Span-460"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-461" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-462" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-467" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">→</span><span class="mn" id="MathJax-Span-468" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mi>R</mi></mrow></msup><mo stretchy="false">→</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">\hat{\beta}^{RR} \rightarrow 0</script></span></li>
<li>If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-469" role="math" style="width: 2.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1002.21em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: STIXGeneral-Italic;">λ</span><span class="mo" id="MathJax-Span-472" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-473" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-18">\lambda = 0</script></span> then <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-474" role="math" style="width: 5.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1004.53em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-475"><span class="msubsup" id="MathJax-Span-476"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="munderover" id="MathJax-Span-479"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-480" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-481" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-485" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-486" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-487" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="munderover" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-491" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-492" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">O</span><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-497" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mi>R</mi></mrow></msup><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">\hat{\beta}^{RR} = \hat{\beta}^{OLS}</script></span></li>
</ul>
<p><br></p>
<p><br></p>
</div>
<div id="ridge-regression" class="section level1">
<h1>Ridge Regression</h1>
<p><img src="./Lecture3_files/unnamed-chunk-1-1.png" width="672"></p>
<p>Ridge Regression was born to avoid problems of non-singularity.</p>
<p>But in addition, it also reduces the variance of the parameters.</p>
<p>Recalling the formula of the variance under homoskedastic error for ridge regression now:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-498" role="math" style="width: 13.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1011.13em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-501" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-503" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-504"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.801em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-505"><span class="mrow" id="MathJax-Span-506"><span class="munderover" id="MathJax-Span-507"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.122em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-509" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.699em; left: 0.539em;"><span class="texatom" id="MathJax-Span-510"><span class="mrow" id="MathJax-Span-511"><span class="mi" id="MathJax-Span-512" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-513" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-514" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-515" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-516" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-517" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mn" id="MathJax-Span-518" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-519" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-521" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-522" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-523" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-524" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-525" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span><span class="mi" id="MathJax-Span-526" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-528" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-529"><span class="mrow" id="MathJax-Span-530"><span class="mo" id="MathJax-Span-531" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-532" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>β</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mi>R</mi></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><mo>+</mo><mi>λ</mi><mi>I</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">
\begin{equation}
    \nonumber
    Var(\hat{\beta}^{RR}) = \sigma^2 (X'X + \lambda I)^{-1}
\end{equation}
</script></span></p>
<p>So the higher <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-533" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1000.48em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-534"><span class="mi" id="MathJax-Span-535" style="font-family: STIXGeneral-Italic;">λ</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">\lambda</script></span> the lower the variance.</p>
<p><br></p>
<p>But what about the bias?</p>
<p><br></p>
<p>… If the gain in terms of variance is higher then the loss in terms of bias, then we should expect an higher predictive power of the model.</p>
<p><br> We can choose among a set of models with different values of lambda.</p>
<p><br></p>
</div>
<div id="edf" class="section level1">
<h1>EDF</h1>
<p>Ridge regression <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;shrink&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-536" role="math" style="width: 3.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1002.8em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-537"><span class="texatom" id="MathJax-Span-538"><span class="mrow" id="MathJax-Span-539"><span class="mtext" id="MathJax-Span-540" style="font-family: STIXGeneral; font-weight: bold;">shrink</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">shrink</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-22">\textbf{shrink}</script></span> parameters to zero, but we still have the same number of variables, so nothing change?… Isn’t it?</p>
<p><br></p>
<p>How many <strong>effective parameters</strong> are we estimating?</p>
<p><strong>Example</strong></p>
<p>How many parameter do you have to estimate if you constrain your variables to be on the circular shape?</p>
<p><br></p>
<p><img src="./Lecture3_files/circle.PNG" width="700" height="100" alt="This is alternate text"></p>
<p><br></p>
<p>…Just one: the angle of the circle!</p>
<p><br></p>
<p>Effective degrees of freedom are the number of parameters to be estimated. In case of OLS regression this number is equal to p, where p is the number of variables plus one (the intercept).</p>
<p>In general:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-541" role="math" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em 1002.98em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-542"><span class="texatom" id="MathJax-Span-543"><span class="mrow" id="MathJax-Span-544"><span class="munderover" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-546" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.241em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-547" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-548" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-549" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-550" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mi>S</mi><mi>Y</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">
\begin{equation}
\nonumber
  \hat{Y} = SY  
\end{equation}
 </script></span></p>
<p>with S the regression matrix which does not depend on Y, Y are the actual values of the output variables and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-551" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em 1000.66em 2.324em -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-552"><span class="texatom" id="MathJax-Span-553"><span class="mrow" id="MathJax-Span-554"><span class="munderover" id="MathJax-Span-555"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-556" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.241em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-557" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-24">\hat{Y}</script></span> the predictions.</p>
<p><br></p>
<p>The general result:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-558" role="math" style="width: 12.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.003em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em 1009.94em 3.515em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-559"><span class="mi" id="MathJax-Span-560" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-561" style="font-family: STIXGeneral-Italic;">D</span><span class="mi" id="MathJax-Span-562" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-563" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-564" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.039em 1006.07em 4.467em -999.997em); top: -4.759em; left: 50%; margin-left: -3.033em;"><span class="mrow" id="MathJax-Span-565"><span class="munderover" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px;"><span style="position: absolute; clip: rect(3.039em 1000.84em 4.408em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-567" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.42em 4.17em -999.997em); top: -4.461em; left: 0.896em;"><span class="mi" id="MathJax-Span-568" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1001.13em 4.17em -999.997em); top: -3.688em; left: 0.896em;"><span class="texatom" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-572" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-573" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-574" style="font-family: STIXGeneral-Italic; padding-left: 0.182em;">c</span><span class="mi" id="MathJax-Span-575" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-576" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-577" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.039em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="texatom" id="MathJax-Span-579"><span class="mrow" id="MathJax-Span-580"><span class="munderover" id="MathJax-Span-581"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-582" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.045em; left: 0.063em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-583" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.42em;"><span class="mi" id="MathJax-Span-584" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-585" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-586" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-587" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-588" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-589" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.039em 1001.01em 4.17em -999.997em); top: -3.211em; left: 50%; margin-left: -0.533em;"><span class="msubsup" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.396em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-591" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.598em;"><span class="mn" id="MathJax-Span-592" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1006.25em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 6.253em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-593" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.996em; border-left: 0px solid; width: 0px; height: 3.004em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mi>D</mi><mi>F</mi><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>c</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><msup><mi>σ</mi><mn>2</mn></msup></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">
\begin{equation}
\nonumber
    EDF = \frac{\sum_{i=1}^n cov(\hat{y}_i, y_i)}{\sigma^2}.
\end{equation}
</script></span></p>
<p>But it can be shown that</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-594" role="math" style="width: 12.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.241em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em 1010.24em 3.991em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-595"><span class="mi" id="MathJax-Span-596" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-597" style="font-family: STIXGeneral-Italic;">D</span><span class="mi" id="MathJax-Span-598" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-599" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-600" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-601" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-602" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-603" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-604" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-605" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-606" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-607" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-609" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-610" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.96em 4.289em -999.997em); top: -2.854em; left: 0.122em;"><span class="texatom" id="MathJax-Span-611"><span class="mrow" id="MathJax-Span-612"><span class="mi" id="MathJax-Span-613" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-614" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-615" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em 1000.36em 4.17em -999.997em); top: -5.176em; left: 0.479em;"><span class="mi" id="MathJax-Span-616" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-617" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-618" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-622" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-623" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.568em; border-left: 0px solid; width: 0px; height: 3.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mi>D</mi><mi>F</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">
\begin{equation}
\nonumber
    EDF = trace(S) = \sum_{i=1}^n S_{i,i}
\end{equation}
</script></span></p>
<p>For linear regression:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-624" role="math" style="width: 8.039em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.67em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1006.67em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-625"><span class="mi" id="MathJax-Span-626" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-627" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-628" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-629" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-630"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-631" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-632" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-633" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-635" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-636"><span class="mrow" id="MathJax-Span-637"><span class="mo" id="MathJax-Span-638" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-639" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msup" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-641" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-642" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mi>X</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mo>′</mo></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">
\begin{equation}
\nonumber
    S = X(X'X)^{-1}X'
\end{equation}
</script></span></p>
<p>For ridge regression:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-643" role="math" style="width: 10.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.574em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1008.57em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-644"><span class="mi" id="MathJax-Span-645" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-646" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-647" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-648" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-649"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-650" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-651" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-652" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-653" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-654" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span><span class="mi" id="MathJax-Span-655" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-656"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-657" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="texatom" id="MathJax-Span-658"><span class="mrow" id="MathJax-Span-659"><span class="mo" id="MathJax-Span-660" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-661" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msup" id="MathJax-Span-662"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-663" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mo" id="MathJax-Span-664" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mi>X</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mo>′</mo></msup><mi>X</mi><mo>+</mo><mi>λ</mi><mi>I</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mo>′</mo></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">
\begin{equation}
\nonumber
    S = X(X'X + \lambda I)^{-1}X'
\end{equation}
</script></span></p>
<p>What is the trace?</p>
<p><br></p>
<p>Using the Singular Value Decomposition</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" role="math" style="width: 5.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.408em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em 1004.41em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-666"><span class="mi" id="MathJax-Span-667" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-668" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-669" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-670" style="font-family: STIXGeneral-Italic;">D</span><span class="msup" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.72em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-672" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.777em;"><span class="mo" id="MathJax-Span-673" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>U</mi><mi>D</mi><msup><mi>V</mi><mo>′</mo></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">
\begin{equation}
    \nonumber
    X = UDV'
\end{equation}
</script></span></p>
<p>with</p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-674" role="math" style="width: 7.801em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.491em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.61em 1006.49em 2.741em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-675"><span class="msup" id="MathJax-Span-676"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.78em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-677" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.836em;"><span class="mo" id="MathJax-Span-678" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-679" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-680" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msup" id="MathJax-Span-681" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.72em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-682" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mo" id="MathJax-Span-683" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-684" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-685" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-686" style="font-family: STIXGeneral-Italic; padding-left: 0.301em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>U</mi><mo>′</mo></msup><mi>U</mi><mo>=</mo><msup><mi>V</mi><mo>′</mo></msup><mi>V</mi><mo>=</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">U'U = V'V = I</script></span> and</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-687" role="math" style="width: 14.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.205em 1011.85em 8.039em -999.997em); top: -5.354em; left: 0.003em;"><span class="mrow" id="MathJax-Span-688"><span class="mi" id="MathJax-Span-689" style="font-family: STIXGeneral-Italic;">D</span><span class="mo" id="MathJax-Span-690" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-691" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-692" style="vertical-align: 2.979em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.33em; left: 0.003em;">⎡<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.134em; left: 0.003em;">⎣<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.438em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.545em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.652em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.241em; left: 0.003em;">⎢<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mtable" id="MathJax-Span-693" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 8.753em; height: 0px;"><span style="position: absolute; clip: rect(3.039em 1000.96em 8.455em -999.997em); top: -6.068em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.348em -999.997em); top: -6.188em; left: 50%; margin-left: -0.473em;"><span class="mtd" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="msubsup" id="MathJax-Span-696"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-697" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mn" id="MathJax-Span-698" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -4.699em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mn" id="MathJax-Span-715" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-732"><span class="mrow" id="MathJax-Span-733"><span class="mo" id="MathJax-Span-734" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-747"><span class="mrow" id="MathJax-Span-748"><span class="mn" id="MathJax-Span-749" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.074em;"></span></span><span style="position: absolute; clip: rect(2.979em 1000.96em 8.396em -999.997em); top: -6.009em; left: 2.027em;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -6.188em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-699"><span class="mrow" id="MathJax-Span-700"><span class="mn" id="MathJax-Span-701" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.96em 4.348em -999.997em); top: -4.699em; left: 50%; margin-left: -0.473em;"><span class="mtd" id="MathJax-Span-716"><span class="mrow" id="MathJax-Span-717"><span class="msubsup" id="MathJax-Span-718"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-719" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mn" id="MathJax-Span-720" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-735"><span class="mrow" id="MathJax-Span-736"><span class="mo" id="MathJax-Span-737" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-750"><span class="mrow" id="MathJax-Span-751"><span class="mn" id="MathJax-Span-752" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.015em;"></span></span><span style="position: absolute; clip: rect(2.979em 1000.48em 8.396em -999.997em); top: -6.009em; left: 4.11em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -6.188em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mn" id="MathJax-Span-704" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -4.699em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-721"><span class="mrow" id="MathJax-Span-722"><span class="mn" id="MathJax-Span-723" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-738"><span class="mrow" id="MathJax-Span-739"><span class="mo" id="MathJax-Span-740" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-753"><span class="mrow" id="MathJax-Span-754"><span class="mn" id="MathJax-Span-755" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.015em;"></span></span><span style="position: absolute; clip: rect(3.039em 1001.07em 7.86em -999.997em); top: -5.473em; left: 5.717em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.693em 1001.07em 4.17em -999.997em); top: -6.188em; left: 50%; margin-left: -0.533em;"><span class="mtd" id="MathJax-Span-705"><span class="mrow" id="MathJax-Span-706"><span class="mo" id="MathJax-Span-707" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-708" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-709" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.693em 1001.07em 4.17em -999.997em); top: -4.699em; left: 50%; margin-left: -0.533em;"><span class="mtd" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mo" id="MathJax-Span-726" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-727" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-728" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.18em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.116em;"><span class="mtd" id="MathJax-Span-741"><span class="mrow" id="MathJax-Span-742"><span class="mo" id="MathJax-Span-743" style="font-family: STIXGeneral-Regular;">:</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.693em 1001.07em 4.17em -999.997em); top: -1.783em; left: 50%; margin-left: -0.533em;"><span class="mtd" id="MathJax-Span-756"><span class="mrow" id="MathJax-Span-757"><span class="mo" id="MathJax-Span-758" style="font-family: STIXGeneral-Regular;">.</span><span class="mo" id="MathJax-Span-759" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span><span class="mo" id="MathJax-Span-760" style="font-family: STIXGeneral-Regular; padding-left: 0.182em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.479em;"></span></span><span style="position: absolute; clip: rect(3.277em 1000.78em 8.991em -999.997em); top: -6.307em; left: 7.979em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -6.188em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-710"><span class="mrow" id="MathJax-Span-711"><span class="mn" id="MathJax-Span-712" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -4.699em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-729"><span class="mrow" id="MathJax-Span-730"><span class="mn" id="MathJax-Span-731" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.235em;"><span class="mtd" id="MathJax-Span-744"><span class="mrow" id="MathJax-Span-745"><span class="mn" id="MathJax-Span-746" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.78em 4.467em -999.997em); top: -1.783em; left: 50%; margin-left: -0.354em;"><span class="mtd" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="msubsup" id="MathJax-Span-763"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-764" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.313em;"></span></span></span></span><span class="mo" id="MathJax-Span-766" style="vertical-align: 2.979em;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.33em; left: 0.003em;">⎤<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.134em; left: 0.003em;">⎦<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.438em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.545em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.652em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.241em; left: 0.003em;">⎥<span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.36em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.068em; border-left: 0px solid; width: 0px; height: 6.646em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>D</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>d</mi><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>d</mi><mn>2</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>:</mo></mtd><mtd><mo>:</mo></mtd><mtd><mo>:</mo></mtd><mtd><mo>:</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd><mtd><msub><mi>d</mi><mi>j</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">
D =
  \begin{bmatrix}
    d_1 & 0 & 0 & ... & 0   \\
    0 & d_2 & 0 & ... & 0   \\
    : & : & : & : & 0\\
    0 & 0 & 0  & ... &d_j  \\
  \end{bmatrix}
</script></span></p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-767" role="math" style="width: 8.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.598em 1007.38em 3.991em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-768"><span class="mi" id="MathJax-Span-769" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-770" style="font-family: STIXGeneral-Italic;">D</span><span class="mi" id="MathJax-Span-771" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-772" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-773" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.86em 1001.19em 4.646em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-774" style="font-family: STIXSizeOneSym; vertical-align: -0.533em;">∑</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.289em -999.997em); top: -2.854em; left: 0.479em;"><span class="mn" id="MathJax-Span-775" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em 1000.18em 4.289em -999.997em); top: -5.235em; left: 0.539em;"><span class="mi" id="MathJax-Span-776" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-777" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.78em 4.467em -999.997em); top: -4.759em; left: 50%; margin-left: -0.354em;"><span class="msubsup" id="MathJax-Span-778"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-779" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-780" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1002.38em 4.467em -999.997em); top: -3.271em; left: 50%; margin-left: -1.188em;"><span class="mrow" id="MathJax-Span-781"><span class="msubsup" id="MathJax-Span-782"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-783" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-785" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-786" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1002.5em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.503em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.568em; border-left: 0px solid; width: 0px; height: 3.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mi>D</mi><mi>F</mi><mo>=</mo><munderover><mo>∑</mo><mn>1</mn><mi>j</mi></munderover><mfrac><msub><mi>d</mi><mi>j</mi></msub><mrow><msub><mi>d</mi><mi>j</mi></msub><mo>+</mo><mi>λ</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">
EDF =  \sum_1^j \frac{d_j}{d_j + \lambda}
</script></span></p>
<p>But…</p>
<ul>
<li>What lambda represents?</li>
<li>How do I choose lambda?</li>
</ul>
<p><br></p>
<p>So..</p>
<p>How do we choose lambda?</p>
<ul>
<li>Minimum in-sample MSE</li>
<li>Minimum R squared</li>
<li>Maximum R squared</li>
<li>Minimum out-of-sample MSE</li>
<li>As usual… We do not care</li>
</ul>
<p><br></p>
<p><br></p>
<p><strong>Cross Validation!</strong></p>
<pre class="r"><code class="r"><span class="comment">## Cross validation</span>

<span class="keyword">library</span><span class="paren">(</span><span class="identifier">glmnet</span><span class="paren">)</span>
<span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>
<span class="identifier">rr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">rr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>



<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">rr.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-2-1.png" width="672"></p>
<p>But an alternative method may be… <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mi&gt;argmin&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-787" role="math" style="width: 19.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1016.19em 3.872em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-788"><span class="msubsup" id="MathJax-Span-789"><span style="display: inline-block; position: relative; width: 2.324em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-790" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-791"><span class="mrow" id="MathJax-Span-792"><span class="mi" id="MathJax-Span-793" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-794" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-795" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-796" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-798" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="munder" id="MathJax-Span-799" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1002.8em 4.408em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-800" style="font-family: STIXGeneral-Regular;">argmin</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.36em 4.408em -999.997em); top: -3.092em; left: 1.253em;"><span class="mi" id="MathJax-Span-801" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-802" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-803" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-804" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-805" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-806" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-808" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="mo" id="MathJax-Span-809" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-810" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-811" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-812" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-813" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-814" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-815" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-816" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-817" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span><span class="texatom" id="MathJax-Span-818"><span class="mrow" id="MathJax-Span-819"><span class="mo" id="MathJax-Span-820" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-821" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-822"><span class="mrow" id="MathJax-Span-823"><span class="mo" id="MathJax-Span-824" style="font-family: STIXGeneral-Regular;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 2.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>o</mi></mrow></msup><mo>=</mo><munder><mi>argmin</mi><mi>β</mi></munder><mo stretchy="false">(</mo><mi>Y</mi><mo>−</mo><mi>X</mi><mi>β</mi><msup><mo stretchy="false">)</mo><mo>′</mo></msup><mo stretchy="false">(</mo><mi>Y</mi><mo>−</mo><mi>X</mi><mi>β</mi><mo stretchy="false">)</mo><mo>+</mo><mi>λ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">
\beta^{Lasso} = \underset{\beta}{\operatorname{argmin}}  (Y - X\beta)'(Y - X\beta) + \lambda |\beta| 
</script></span></p>
<p>So…Which one?</p>
<p><br></p>
<p><strong>Differences</strong></p>
<ul>
<li>Lasso shrink some coefficients to zero after a certain treshold for lambda (features selection).</li>
<li>Ridge never shrinks coefficients completely to zero.</li>
</ul>
<p><br></p>
<p><img src="./Lecture3_files/LassoRidgeHTF.PNG" width="700" height="300" alt="This is alternate text"></p>
<pre class="r"><code class="r"><span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="identifier">xvar</span><span class="operator">=</span><span class="string">'lambda'</span>, <span class="identifier">lwd</span><span class="operator">=</span><span class="number">2</span>, <span class="identifier">main</span><span class="operator">=</span> <span class="string">"White Wine Data"</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-3-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="identifier">xvar</span><span class="operator">=</span><span class="string">'lambda'</span>, <span class="identifier">lwd</span><span class="operator">=</span><span class="number">2</span>, <span class="identifier">main</span><span class="operator">=</span> <span class="string">"White Wine Data"</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-3-2.png" width="672"></p>
<p>And with cross validation…</p>
<pre class="r"><code class="r"><span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>
<span class="identifier">rr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">rr.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-4-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>
<span class="identifier">rr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">rr.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-4-2.png" width="672"></p>
<ul>
<li>Lasso shrinks some coefficients to zero after a certain treshold for lambda</li>
<li>Ridge never shrinks coefficients to zero</li>
</ul>
<p>Moreover:</p>
<ul>
<li>Lasso picks at most as many covariates as the observations(no overidentifed models)</li>
<li>When covariates are highly correlated Lasso will tend to pick just one of them</li>
</ul>
<p><br></p>
<p>But you might want to have a predictor between the two:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mi&gt;argmin&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-825" role="math" style="width: 26.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.384em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1022.32em 3.872em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-826"><span class="msubsup" id="MathJax-Span-827"><span style="display: inline-block; position: relative; width: 2.324em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-828" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="texatom" id="MathJax-Span-829"><span class="mrow" id="MathJax-Span-830"><span class="mi" id="MathJax-Span-831" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-832" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-833" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-834" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-835" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-836" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="munder" id="MathJax-Span-837" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1002.8em 4.408em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-838" style="font-family: STIXGeneral-Regular;">argmin</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.36em 4.408em -999.997em); top: -3.092em; left: 1.253em;"><span class="mi" id="MathJax-Span-839" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-840" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-841" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-842" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-843" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-844" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-845"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.3em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-846" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.36em;"><span class="mo" id="MathJax-Span-847" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-848" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-849" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-850" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-851" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-852" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-853" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-854" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-855" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">λ</span><span class="mo" id="MathJax-Span-856" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-857" style="font-family: STIXGeneral-Italic;">α</span><span class="texatom" id="MathJax-Span-858"><span class="mrow" id="MathJax-Span-859"><span class="mo" id="MathJax-Span-860" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-861" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-862"><span class="mrow" id="MathJax-Span-863"><span class="mo" id="MathJax-Span-864" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mo" id="MathJax-Span-865" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">+</span><span class="mo" id="MathJax-Span-866" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">(</span><span class="mn" id="MathJax-Span-867" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-868" style="font-family: STIXGeneral-Regular; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-869" style="font-family: STIXGeneral-Italic; padding-left: 0.241em;">α</span><span class="mo" id="MathJax-Span-870" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-871"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-872" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.598em;"><span class="mn" id="MathJax-Span-873" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-874" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 2.575em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mi>E</mi><mi>l</mi><mi>N</mi><mi>e</mi><mi>t</mi></mrow></msup><mo>=</mo><munder><mi>argmin</mi><mi>β</mi></munder><mo stretchy="false">(</mo><mi>Y</mi><mo>−</mo><mi>X</mi><mi>β</mi><msup><mo stretchy="false">)</mo><mo>′</mo></msup><mo stretchy="false">(</mo><mi>Y</mi><mo>−</mo><mi>X</mi><mi>β</mi><mo stretchy="false">)</mo><mo>+</mo><mi>λ</mi><mo stretchy="false">(</mo><mi>α</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><msup><mi>β</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">
\begin{equation}
\beta^{ElNet} = \underset{\beta}{\operatorname{argmin}}  (Y - X\beta)'(Y - X\beta) + \lambda (\alpha |\beta| + (1 - \alpha) \beta^2) 
\end{equation}
</script></span></p>
</div>
<div id="example" class="section level1">
<h1>Example</h1>
<p>We are still interested in predicting what is the expected quality of a wine controlling for chemical attributes.</p>
<p>Previously we showed the result of the analysis, here we provide further details on some issues to be careful about.</p>
<p>The data set is available on the web page.</p>
<pre class="r"><code class="r"><span class="comment">## Costruct a sequence for lambda</span>

<span class="identifier">wine.white</span> <span class="operator">&lt;-</span> <span class="identifier">read.table</span><span class="paren">(</span><span class="string">"./data/wine-white.txt"</span><span class="paren">)</span>
<span class="keyword">library</span><span class="paren">(</span><span class="identifier">glmnet</span><span class="paren">)</span>
<span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">names</span><span class="paren">(</span><span class="identifier">wine.white</span><span class="paren">)</span></code></pre>
<pre><code>##  [1] "fixed.acidity"        "volatile.acidity"     "citric.acid"         
##  [4] "residual.sugar"       "chlorides"            "free.sulfur.dioxide" 
##  [7] "total.sulfur.dioxide" "density"              "pH"                  
## [10] "sulphates"            "alcohol"              "quality"</code></pre>
<pre class="r"><code class="r"><span class="identifier">y</span> <span class="operator">&lt;-</span> <span class="identifier">wine.white</span><span class="operator">$</span><span class="identifier">quality</span>

<span class="comment">## Construct the covariate matrix</span>

<span class="identifier">xm</span> <span class="operator">&lt;-</span> <span class="identifier">wine.white</span><span class="paren">[</span>,<span class="operator">-</span><span class="number">12</span><span class="paren">]</span>
<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xm</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span> 

<span class="comment"># alpha = 1 for lasso, alpha = 0.5 for elastic net with 0.5 alpha</span>

<span class="comment">## Make a plot of coefficients</span>

<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="identifier">xvar</span><span class="operator">=</span><span class="string">'lambda'</span>, <span class="identifier">lwd</span><span class="operator">=</span><span class="number">2</span>, <span class="identifier">main</span><span class="operator">=</span> <span class="string">"White Wine Data"</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-5-1.png" width="672"></p>
<p><br></p>
<p><strong>Something wrong?</strong></p>
<p><br></p>
<pre class="r"><code class="r"><span class="comment"># Standardize</span>
<span class="identifier">p</span> <span class="operator">&lt;-</span> <span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">xm</span><span class="paren">)</span>
<span class="identifier">n</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">xm</span><span class="paren">)</span>
<span class="identifier">xmn</span> <span class="operator">&lt;-</span> <span class="identifier">scale</span><span class="paren">(</span><span class="identifier">scale</span><span class="paren">(</span><span class="identifier">xm</span><span class="paren">)</span>, <span class="identifier">center</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">scale</span><span class="operator">=</span><span class="identifier">rep</span><span class="paren">(</span><span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">n</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span>, <span class="identifier">p</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="identifier">xvar</span><span class="operator">=</span><span class="string">'lambda'</span>, <span class="identifier">lwd</span><span class="operator">=</span><span class="number">2</span>, <span class="identifier">main</span><span class="operator">=</span> <span class="string">"White Wine Data"</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-6-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment">## Add a legend</span>

<span class="identifier">lbs_fun</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span>
  <span class="identifier">L</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">fit</span><span class="operator">$</span><span class="identifier">lambda</span><span class="paren">)</span>
  <span class="identifier">x</span> <span class="operator">&lt;-</span> <span class="identifier">log</span><span class="paren">(</span><span class="identifier">fit</span><span class="operator">$</span><span class="identifier">lambda</span><span class="paren">[</span><span class="identifier">L</span><span class="paren">]</span><span class="paren">)</span>
  <span class="identifier">y</span> <span class="operator">&lt;-</span> <span class="identifier">fit</span><span class="operator">$</span><span class="identifier">beta</span><span class="paren">[</span>, <span class="identifier">L</span><span class="paren">]</span>
  <span class="identifier">labs</span> <span class="operator">&lt;-</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span>
  <span class="identifier">legend</span><span class="paren">(</span><span class="string">'bottomleft'</span>, <span class="identifier">legend</span><span class="operator">=</span><span class="identifier">labs</span>, <span class="identifier">col</span><span class="operator">=</span><span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">labs</span><span class="paren">)</span>, <span class="identifier">lty</span><span class="operator">=</span><span class="number">1</span>, <span class="identifier">cex</span><span class="operator">=</span><span class="number">0.7</span> <span class="paren">)</span> 
<span class="paren">}</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="identifier">xvar</span><span class="operator">=</span><span class="string">"lambda"</span>, <span class="identifier">col</span><span class="operator">=</span><span class="number">1</span><span class="operator">:</span><span class="identifier">dim</span><span class="paren">(</span><span class="identifier">coef</span><span class="paren">(</span><span class="identifier">fit</span><span class="paren">)</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span>, <span class="identifier">main</span><span class="operator">=</span><span class="string">"White Wine Data"</span><span class="paren">)</span>
<span class="identifier">lbs_fun</span><span class="paren">(</span><span class="identifier">fit</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-6-2.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment">## Cross validation</span>

<span class="keyword">library</span><span class="paren">(</span><span class="identifier">glmnet</span><span class="paren">)</span>
<span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>
<span class="identifier">rr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">rr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0</span><span class="paren">)</span>



<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">rr.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-6-3.png" width="672"></p>
<p>An alternative way is to pick rr.cv$1.se, could you explain why?</p>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p><br></p>
<p>We are interested in predicting the level of alchol consumption during the weekend for students, controlling for many social and academic indicators. Some of them are the average grades for three years, the income of the family, the age, etc. In total we have 32 variables, but we want to find just the ones most correlated with alchol consumption.</p>
<p><br></p>
<p>Which model would you use?</p>
<p><br></p>
<p>Do the following:</p>
<ul>
<li>Download the student txt file</li>
<li>Explore the variables and construct two different linear models</li>
<li>Report the interpretation of the coefficients</li>
</ul>
<p>Note: the dependent variable is Walc (Week-end alchol consumption)</p>
<p><br></p>
<pre class="r"><code class="r"><span class="comment">### Exercise Student</span>

<span class="identifier">student</span> <span class="operator">&lt;-</span> <span class="identifier">read.table</span><span class="paren">(</span><span class="string">"./data/student.matG.txt"</span><span class="paren">)</span>

<span class="identifier">reg1</span> <span class="operator">&lt;-</span> <span class="identifier">lm</span><span class="paren">(</span><span class="identifier">Walc</span><span class="operator">~</span><span class="identifier">school</span>, <span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">)</span>
<span class="identifier">reg2</span> <span class="operator">&lt;-</span> <span class="identifier">lm</span><span class="paren">(</span><span class="identifier">Walc</span><span class="operator">~</span> <span class="identifier">school</span> <span class="operator">+</span> <span class="identifier">age</span> <span class="operator">+</span> <span class="identifier">health</span> <span class="operator">+</span> <span class="identifier">school</span><span class="operator">*</span><span class="identifier">health</span> , <span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">)</span> 

<span class="identifier">summary</span><span class="paren">(</span><span class="identifier">reg1</span><span class="paren">)</span></code></pre>
<pre><code>## 
## Call:
## lm(formula = Walc ~ school, data = student)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.5217 -1.2607 -0.2607  0.7393  2.7393 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.26074    0.06888  32.821   &lt;2e-16 ***
## schoolMS     0.26099    0.20184   1.293    0.197    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.287 on 393 degrees of freedom
## Multiple R-squared:  0.004236,   Adjusted R-squared:  0.001703 
## F-statistic: 1.672 on 1 and 393 DF,  p-value: 0.1968</code></pre>
<pre class="r"><code class="r"><span class="identifier">summary</span><span class="paren">(</span><span class="identifier">reg2</span><span class="paren">)</span></code></pre>
<pre><code>## 
## Call:
## lm(formula = Walc ~ school + age + health + school * health, 
##     data = student)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.8027 -1.2238 -0.2779  0.8379  3.1672 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     -0.001606   0.938437  -0.002   0.9986  
## schoolMS         0.225423   0.520777   0.433   0.6654  
## age              0.115782   0.054790   2.113   0.0352 *
## health           0.097726   0.049720   1.966   0.0501 .
## schoolMS:health -0.035411   0.140793  -0.252   0.8016  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.279 on 390 degrees of freedom
## Multiple R-squared:  0.02451,    Adjusted R-squared:  0.0145 
## F-statistic: 2.449 on 4 and 390 DF,  p-value: 0.04577</code></pre>
<p><br></p>
<p>Now:</p>
<ul>
<li>Construct a sequence of lambda from <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-875" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em 1001.91em 2.324em -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-876"><span class="msubsup" id="MathJax-Span-877"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-878" style="font-family: STIXGeneral-Regular;">10</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.015em;"><span class="texatom" id="MathJax-Span-879"><span class="mrow" id="MathJax-Span-880"><span class="mo" id="MathJax-Span-881" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-882" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>4</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-35">10^{-4}</script></span> to <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-883" role="math" style="width: 1.729em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em 1001.43em 2.324em -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-884"><span class="msubsup" id="MathJax-Span-885"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-886" style="font-family: STIXGeneral-Regular;">10</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.015em;"><span class="mn" id="MathJax-Span-887" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-36">10^4</script></span><br>
</li>
<li>Standardize the covariates</li>
<li>Open in the library glmnet</li>
<li>Use cross validation to find the best lambda</li>
<li>Construct a lasso with the lambda with minimum error</li>
</ul>
<p>Remember to set alpha = 1.</p>
<p>Hint: Code for the first two points is provided. <br></p>
<pre class="r"><code class="r"><span class="comment">## Expand matrix</span>

<span class="identifier">xm</span> <span class="operator">&lt;-</span> <span class="identifier">model.matrix</span><span class="paren">(</span><span class="operator">~</span>. ,<span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span>,<span class="operator">-</span><span class="number">27</span><span class="paren">]</span><span class="paren">)</span><span class="paren">[</span>,<span class="operator">-</span><span class="number">1</span><span class="paren">]</span>  
<span class="identifier">y</span> <span class="operator">&lt;-</span> <span class="identifier">student</span><span class="paren">[</span>,<span class="number">27</span><span class="paren">]</span>

<span class="comment">## Use this functions to standardize</span>

<span class="identifier">standard_for_dummy</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">{</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">duplicated</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="operator">==</span><span class="number">2</span><span class="paren">)</span>
<span class="paren">{</span> <span class="keyword">return</span><span class="paren">(</span><span class="number">1</span><span class="paren">)</span><span class="paren">}</span>                               
<span class="keyword">return</span><span class="paren">(</span><span class="identifier">sd</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">)</span>                                                      <span class="paren">}</span>

<span class="identifier">sd.tr</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">xm</span>, <span class="number">2</span>, <span class="identifier">standard_for_dummy</span><span class="paren">)</span> 

<span class="identifier">mu_for_dummy</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">{</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">duplicated</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="operator">==</span><span class="number">2</span><span class="paren">)</span>
<span class="paren">{</span> <span class="keyword">return</span><span class="paren">(</span><span class="number">0.5</span><span class="paren">)</span><span class="paren">}</span>                               
<span class="identifier">mean</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span>      <span class="paren">}</span>

<span class="identifier">mu.tr</span> <span class="operator">&lt;-</span><span class="identifier">apply</span><span class="paren">(</span><span class="identifier">xm</span>, <span class="number">2</span>, <span class="identifier">mu_for_dummy</span><span class="paren">)</span> 

<span class="comment">## New covariate matrix</span>


<span class="identifier">xmn</span> <span class="operator">&lt;-</span> <span class="identifier">scale</span><span class="paren">(</span><span class="identifier">xm</span>, <span class="identifier">center</span> <span class="operator">=</span> <span class="identifier">mu.tr</span>, <span class="identifier">scale</span><span class="operator">=</span><span class="identifier">sd.tr</span><span class="paren">)</span>

<span class="comment">## Set your lambda </span>

<span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p><br></p>
<p><strong>Solution:</strong></p>
<p><br></p>
<pre class="r"><code class="r"><span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>

<span class="identifier">lr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span>,<span class="number">27</span><span class="paren">]</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>


<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span></code></pre>
<p><br></p>
<p>Finally:</p>
<ul>
<li>Cross Validate the linear model using the skeleton for cross validation provided</li>
<li>Assess which model is the best</li>
<li>Do you think it is the correct way to compare the models?</li>
</ul>
<p><br></p>
<p>Optional:</p>
<ul>
<li>Use fit$beta to see the coefficients actually used by the best lasso</li>
<li>Question: do you think it is a proper way to assess causality between variables? Why or why not?</li>
</ul>
<p><br></p>
<p><strong>Solution</strong></p>
<p><br></p>
<pre class="r"><code class="r"><span class="identifier">set.seed</span><span class="paren">(</span><span class="number">123</span><span class="paren">)</span>

  <span class="identifier">n</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span>
  <span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>

  <span class="identifier">ii</span> <span class="operator">&lt;-</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">k</span>, <span class="identifier">length</span><span class="operator">=</span> <span class="identifier">n</span><span class="paren">)</span><span class="paren">)</span>
  
  <span class="identifier">pr.1</span> <span class="operator">&lt;-</span> <span class="identifier">pr.2</span> <span class="operator">&lt;-</span> <span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span>
  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">j</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">{</span>
    <span class="identifier">hold</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">ii</span> <span class="operator">==</span> <span class="identifier">j</span><span class="paren">)</span>
    <span class="identifier">train</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">ii</span> <span class="operator">!=</span> <span class="identifier">j</span><span class="paren">)</span>
  
    
  <span class="identifier">reg1</span> <span class="operator">&lt;-</span> <span class="identifier">lm</span><span class="paren">(</span><span class="identifier">Walc</span><span class="operator">~</span><span class="identifier">school</span>, <span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">train</span>,<span class="paren">]</span><span class="paren">)</span>
  <span class="identifier">reg2</span> <span class="operator">&lt;-</span> <span class="identifier">lm</span><span class="paren">(</span><span class="identifier">Walc</span><span class="operator">~</span> <span class="identifier">school</span> <span class="operator">+</span> <span class="identifier">age</span> <span class="operator">+</span> <span class="identifier">health</span> <span class="operator">+</span> <span class="identifier">school</span><span class="operator">*</span><span class="identifier">health</span> , <span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">train</span>,<span class="paren">]</span><span class="paren">)</span> 

   <span class="identifier">pr.1</span><span class="paren">[</span><span class="identifier">hold</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">predict</span><span class="paren">(</span><span class="identifier">reg1</span>, <span class="identifier">newdata</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">hold</span>,<span class="paren">]</span><span class="paren">)</span>
    <span class="identifier">pr.2</span><span class="paren">[</span><span class="identifier">hold</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">predict</span><span class="paren">(</span><span class="identifier">reg2</span>, <span class="identifier">newdata</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">hold</span>,<span class="paren">]</span><span class="paren">)</span>

  <span class="paren">}</span>

<span class="identifier">mspe1</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">pr.1</span><span class="operator">-</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span>
<span class="identifier">mspe2</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">pr.2</span><span class="operator">-</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span>

<span class="identifier">print</span><span class="paren">(</span><span class="identifier">cbind</span><span class="paren">(</span><span class="identifier">mspe1</span>, <span class="identifier">mspe2</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<pre><code>##         mspe1    mspe2
## [1,] 1.655833 1.650803</code></pre>
<pre class="r"><code class="r"><span class="identifier">plot</span><span class="paren">(</span><span class="identifier">lr.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-10-1.png" width="672"></p>
<p><br></p>
<p><strong>Correct way:</strong></p>
<p><br></p>
<pre class="r"><code class="r"><span class="identifier">set.seed</span><span class="paren">(</span><span class="number">123</span><span class="paren">)</span>

  <span class="identifier">n</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span>
  <span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>

  <span class="identifier">ii</span> <span class="operator">&lt;-</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">k</span>, <span class="identifier">length</span><span class="operator">=</span> <span class="identifier">n</span><span class="paren">)</span><span class="paren">)</span>
  
  <span class="identifier">pr.1</span> <span class="operator">&lt;-</span> <span class="identifier">pr.2</span> <span class="operator">&lt;-</span> <span class="identifier">pr.l</span> <span class="operator">&lt;-</span> <span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span>
  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">j</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">{</span>
    <span class="identifier">hold</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">ii</span> <span class="operator">==</span> <span class="identifier">j</span><span class="paren">)</span>
    <span class="identifier">train</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">ii</span> <span class="operator">!=</span> <span class="identifier">j</span><span class="paren">)</span>
    <span class="identifier">xx.tr</span> <span class="operator">&lt;-</span> <span class="identifier">xmn</span><span class="paren">[</span><span class="identifier">train</span>,<span class="paren">]</span>
    <span class="identifier">y.tr</span> <span class="operator">&lt;-</span>  <span class="identifier">y</span><span class="paren">[</span><span class="identifier">train</span><span class="paren">]</span>
    <span class="identifier">xx.te</span> <span class="operator">&lt;-</span> <span class="identifier">xmn</span><span class="paren">[</span><span class="identifier">hold</span>,<span class="paren">]</span>
    
  <span class="identifier">reg1</span> <span class="operator">&lt;-</span> <span class="identifier">lm</span><span class="paren">(</span><span class="identifier">Walc</span><span class="operator">~</span><span class="identifier">school</span>, <span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">train</span>,<span class="paren">]</span><span class="paren">)</span>
  <span class="identifier">reg2</span> <span class="operator">&lt;-</span> <span class="identifier">lm</span><span class="paren">(</span><span class="identifier">Walc</span><span class="operator">~</span> <span class="identifier">school</span> <span class="operator">+</span> <span class="identifier">age</span> <span class="operator">+</span> <span class="identifier">health</span> <span class="operator">+</span> <span class="identifier">school</span><span class="operator">*</span><span class="identifier">health</span> , <span class="identifier">data</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">train</span>,<span class="paren">]</span><span class="paren">)</span> 

    
 
    <span class="comment">### find the best ridge on the TRAINING SET!</span>
    <span class="identifier">lr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xx.tr</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y.tr</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>


<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xx.tr</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y.tr</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>

    <span class="identifier">pr.1</span><span class="paren">[</span><span class="identifier">hold</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">predict</span><span class="paren">(</span><span class="identifier">reg1</span>, <span class="identifier">newdata</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">hold</span>,<span class="paren">]</span><span class="paren">)</span>
    <span class="identifier">pr.2</span><span class="paren">[</span><span class="identifier">hold</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">predict</span><span class="paren">(</span><span class="identifier">reg2</span>, <span class="identifier">newdata</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span><span class="identifier">hold</span>,<span class="paren">]</span><span class="paren">)</span>
    
    <span class="identifier">pr.l</span><span class="paren">[</span><span class="identifier">hold</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">predict</span><span class="paren">(</span><span class="identifier">fit</span>, <span class="identifier">newx</span><span class="operator">=</span><span class="identifier">xx.te</span><span class="paren">)</span>
  <span class="paren">}</span>

<span class="identifier">mspe1</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">pr.1</span><span class="operator">-</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span>
<span class="identifier">mspe2</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">pr.2</span><span class="operator">-</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span>
<span class="identifier">mspe.Lasso</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">pr.l</span><span class="operator">-</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span>
<span class="identifier">print</span><span class="paren">(</span><span class="identifier">cbind</span><span class="paren">(</span><span class="identifier">mspe1</span>, <span class="identifier">mspe2</span>, <span class="identifier">mspe.Lasso</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<pre><code>##         mspe1    mspe2 mspe.Lasso
## [1,] 1.655833 1.650803   1.184304</code></pre>
<p><br></p>
<p><strong>Why did we cross validated twice?</strong></p>
<p><br></p>
<p><br></p>
<p>The choice of lambda is done by cross validating the whole data set and THEN using the minimum lambda for constructing the regression. By doing so the regression becomes:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-888" role="math" style="width: 4.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.396em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em 1003.4em 2.92em -999.997em); top: -2.557em; left: 0.003em;"><span class="mrow" id="MathJax-Span-889"><span class="texatom" id="MathJax-Span-890"><span class="mrow" id="MathJax-Span-891"><span class="munderover" id="MathJax-Span-892"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.66em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-893" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.241em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.36em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-894" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.235em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-895" style="font-family: STIXGeneral-Regular; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-896" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-897" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-898" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-899" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.562em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><msub><mi>S</mi><mi>λ</mi></msub><mi>Y</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-37">
\begin{equation}
\nonumber
\hat{Y}= S_\lambda Y
\end{equation}
 </script></span></p>
<p>Where <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-900" role="math" style="width: 1.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em 1000.96em 2.503em -999.997em); top: -2.14em; left: 0.003em;"><span class="mrow" id="MathJax-Span-901"><span class="msubsup" id="MathJax-Span-902"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.54em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-903" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>λ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">S_\lambda</script></span> is chosen looking at in-sample observations.</p>
<p>But to have an unbiased estimator we need always out-of-sample information.</p>
<p><br></p>
<p>The correct way of doing cross validation is:</p>
<ul>
<li>Randomly divide the data in k folds</li>
<li>Find the tuning parameter (lambda) on k-1 folds</li>
<li>Train the model on k-1 folds</li>
<li>Compute the MSPE on the remaining fold</li>
<li>Repeat the process k times and pick the mean for the MSPE</li>
</ul>
<p>Every time you must cross validate everything, also the way you select the model!</p>
<p><br></p>
<p><br></p>
<p><strong>Optional Question: Solution</strong></p>
<pre class="r"><code class="r"><span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>

<span class="identifier">lr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">student</span><span class="paren">[</span>,<span class="number">27</span><span class="paren">]</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>


<span class="identifier">fit</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>

<span class="identifier">fit</span><span class="operator">$</span><span class="identifier">beta</span></code></pre>
<pre><code>## 40 x 1 sparse Matrix of class "dgCMatrix"
##                            s0
## schoolMS          .          
## sexM              0.490585276
## age               0.021504423
## addressU         -0.225973581
## famsizeLE3        0.121385336
## PstatusT          .          
## Medu             -0.018117504
## Fedu              .          
## Mjobhealth        .          
## Mjobother         .          
## Mjobservices      .          
## Mjobteacher       .          
## Fjobhealth        .          
## Fjobother         0.060404901
## Fjobservices      0.232564592
## Fjobteacher      -0.234248942
## reasonhome        .          
## reasonother       0.183988257
## reasonreputation  .          
## guardianmother   -0.012841937
## guardianother    -0.157157040
## traveltime        0.058417780
## studytime        -0.157395739
## failures          0.018325220
## schoolsupyes      .          
## famsupyes        -0.032471971
## paidyes           0.243145424
## activitiesyes    -0.085106738
## nurseryyes       -0.208000612
## higheryes         .          
## internetyes       .          
## romanticyes       .          
## famrel           -0.154080537
## freetime          .          
## goout             0.482052557
## health            0.067987036
## absences          0.117123906
## G1               -0.004467456
## G2                .          
## G3                .</code></pre>
<p><br></p>
<p><strong>Question: do you think it is a proper way to assess causality between variables? Why or why not?</strong></p>
<p>No, it is not a proper way to find causal relationship among variables. In fact if some variables are highly correlated each other just one or few of these variables will enter in the regression, but this does not mean that they have a causal relationship with the dependent variable.</p>
<p>For example in our case mother education (Meduc) enters in the regression, while father education (Feduc) does not. Probably the variables are highly correlated(same education of husbands) and just one of the two enter in the regression (the other is masked). But still… Also father education may have an effect on alchol consumption of the son!</p>
<p><br></p>
</div>
</div>
<div id="optional-challenge" class="section level1">
<h1>Optional Challenge</h1>
<p><br></p>
<p>We want to predict the waiting time for a bus in Rome at a certain stop. To do so, we have collected data from Atac, the firm who manages the public traffic service between April and May 2016. We have at disposal 193 variables and the dependent variable is travel time between two points of the city. The only objective is to have an accurate out-of-sample predictive power.</p>
<p>Which model would you use? How would you choose the model?</p>
<p>Open the text file Atacfinal and set the dependent variable the 160th columns (Hint: use y = data[,160], xm = data[,-160]).</p>
<ul>
<li>Construct a lasso regression and an elastic net regression with alpha = 0.5.</li>
<li>Use cross validation to choose the best lambda in each case and compare the values of lambda.</li>
<li>Plot the behaviour of the MSPE as a function of lambda for the lasso regression and elastic net regression.</li>
<li>Which difference do you notice? Which one do you prefer? How many variables would you use?</li>
</ul>
<p>Hint: Remember to standardize covariates!</p>
<p><br></p>
<pre class="r"><code class="r"><span class="comment">## Challenging exercise: Atac</span>

<span class="identifier">data</span> <span class="operator">&lt;-</span> <span class="identifier">read.table</span><span class="paren">(</span><span class="string">"./data/Atacfinal.txt"</span><span class="paren">)</span>

<span class="identifier">y</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span>,<span class="number">160</span><span class="paren">]</span>
<span class="identifier">xm</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span>,<span class="operator">-</span><span class="number">160</span><span class="paren">]</span>

<span class="comment">## Standardize covariates</span>


<span class="identifier">standard_for_dummy</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">{</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">duplicated</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="operator">==</span><span class="number">2</span><span class="paren">)</span>
<span class="paren">{</span> <span class="keyword">return</span><span class="paren">(</span><span class="number">1</span><span class="paren">)</span><span class="paren">}</span>                               
<span class="keyword">return</span><span class="paren">(</span><span class="identifier">sd</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">)</span>                                                      <span class="paren">}</span>

<span class="identifier">sd.tr</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">xm</span>, <span class="number">2</span>, <span class="identifier">standard_for_dummy</span><span class="paren">)</span> 

<span class="identifier">mu_for_dummy</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">{</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">duplicated</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="operator">==</span><span class="number">2</span><span class="paren">)</span>
<span class="paren">{</span> <span class="keyword">return</span><span class="paren">(</span><span class="number">0.5</span><span class="paren">)</span><span class="paren">}</span>                               
<span class="identifier">mean</span><span class="paren">(</span><span class="identifier">k</span><span class="paren">)</span>      <span class="paren">}</span>

<span class="identifier">mu.tr</span> <span class="operator">&lt;-</span><span class="identifier">apply</span><span class="paren">(</span><span class="identifier">xm</span>, <span class="number">2</span>, <span class="identifier">mu_for_dummy</span><span class="paren">)</span> 

<span class="comment">## New covariate matrix</span>


<span class="identifier">xmn</span> <span class="operator">&lt;-</span> <span class="identifier">scale</span><span class="paren">(</span><span class="identifier">xm</span>, <span class="identifier">center</span> <span class="operator">=</span> <span class="identifier">mu.tr</span>, <span class="identifier">scale</span><span class="operator">=</span><span class="identifier">sd.tr</span><span class="paren">)</span>

<span class="comment">## Set your lambda </span>

<span class="identifier">lambdas.rr</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">seq</span><span class="paren">(</span><span class="operator">-</span><span class="number">4</span>, <span class="number">4</span>, <span class="identifier">length</span><span class="operator">=</span><span class="number">50</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">k</span> <span class="operator">&lt;-</span> <span class="number">10</span>

<span class="identifier">lr.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>


<span class="identifier">fit.lasso</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">1</span><span class="paren">)</span>

<span class="identifier">en.cv</span> <span class="operator">&lt;-</span> <span class="identifier">cv.glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">lambdas.rr</span>, <span class="identifier">nfolds</span><span class="operator">=</span><span class="identifier">k</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0.5</span><span class="paren">)</span>


<span class="identifier">fit.net</span> <span class="operator">&lt;-</span> <span class="identifier">glmnet</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">xmn</span><span class="paren">)</span>, <span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">lambda</span><span class="operator">=</span><span class="identifier">rr.cv</span><span class="operator">$</span><span class="identifier">lambda.min</span>, <span class="identifier">alpha</span><span class="operator">=</span><span class="number">0.5</span><span class="paren">)</span>

<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">lr.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-13-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">plot</span><span class="paren">(</span><span class="identifier">en.cv</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-13-2.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment">## See the number of variables </span>


<span class="identifier">par</span><span class="paren">(</span><span class="identifier">mar</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">5</span><span class="paren">)</span><span class="paren">)</span>


<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">lr.cv</span><span class="paren">)</span>

<span class="identifier">par</span><span class="paren">(</span><span class="identifier">new</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">nzero</span> <span class="operator">~</span> <span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">lambda</span>, <span class="identifier">xlab</span><span class="operator">=</span><span class="literal">NA</span>, <span class="identifier">ylab</span> <span class="operator">=</span><span class="literal">NA</span>, <span class="identifier">type</span><span class="operator">=</span><span class="string">"n"</span>, <span class="identifier">axes</span><span class="operator">=</span><span class="literal">F</span><span class="paren">)</span>
<span class="identifier">axis</span><span class="paren">(</span><span class="identifier">side</span> <span class="operator">=</span> <span class="number">4</span><span class="paren">)</span>
<span class="identifier">mtext</span><span class="paren">(</span><span class="identifier">side</span> <span class="operator">=</span> <span class="number">4</span>, <span class="identifier">line</span> <span class="operator">=</span> <span class="number">3</span>, <span class="string">'Number of Variables'</span><span class="paren">)</span>
<span class="identifier">lines</span><span class="paren">(</span><span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">nzero</span> <span class="operator">~</span> <span class="identifier">lr.cv</span><span class="operator">$</span><span class="identifier">lambda</span>, <span class="identifier">xlab</span><span class="operator">=</span><span class="string">"lambda"</span>, <span class="identifier">ylab</span> <span class="operator">=</span><span class="string">"Number of variables"</span>, <span class="identifier">col</span><span class="operator">=</span><span class="string">"blue"</span><span class="paren">)</span></code></pre>
<p><img src="./Lecture3_files/unnamed-chunk-13-3.png" width="672"></p>
<p><br></p>
<p><strong>The actual error of Atac is 7000, you did better, congratulations!!</strong></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</div>
  </div>



<iframe id="rdbIndicator" width="100%" height="270" border="0" src="./Lecture3_files/indicator.html" style="display: none; border: 0; position: fixed; left: 0; top: 0; z-index: 2147483647"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>